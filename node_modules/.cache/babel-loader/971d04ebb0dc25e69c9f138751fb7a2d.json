{"ast":null,"code":"import Slider from '@material-ui/core/Slider';\nimport { withStyles } from '@material-ui/core/styles';\nimport { get } from '../services/api';\nconst months = ['Janeiro', 'Fevereio', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];\nconst weekDays = ['Domingo', 'Segunda-feira', 'Terça-feira', 'Quarta-feira', 'Quinta-feira', 'Sexta-feira', 'Sábado'];\nconst locationCodes = {\n  Aveiro: 1010500,\n  Beja: 1020500,\n  Braga: 1030300,\n  Bragança: 1040200,\n  'Castelo Branco': 1050200,\n  Coimbra: 1060300,\n  Évora: 1070500,\n  Faro: 1080500,\n  Guarda: 1090700,\n  Leiria: 1100900,\n  Lisboa: 1110600,\n  Portalegre: 1121400,\n  Porto: 1131200,\n  Santarém: 1141600,\n  Setúbal: 1151200,\n  'Viana do Castelo': 1160900,\n  'Vila Real': 1171400,\n  Viseu: 1182300\n};\n\nfunction toRad(Value) {\n  return Value * Math.PI / 180;\n}\n\nfunction calcCrow(lat1, lon1, lat2, lon2) {\n  var R = 6371; // km\n\n  var dLat = toRad(lat2 - lat1);\n  var dLon = toRad(lon2 - lon1);\n  var lat1 = toRad(lat1);\n  var lat2 = toRad(lat2);\n  var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  var d = R * c;\n  return d;\n}\n\nconst CustomSlider = withStyles({\n  root: {\n    width: '75%'\n  },\n  markLabel: {\n    color: '#a9a9a9'\n  },\n  markLabelActive: {\n    color: '#f1f1f1'\n  }\n})(Slider);\n\nDate.prototype.addDays = function (days) {\n  var date = new Date(this.valueOf());\n  date.setDate(date.getDate() + days);\n  return date;\n};\n\nconst currentDate = new Date();\nconst marks = [{\n  value: 1,\n  label: currentDate.addDays(0).getDate() + ' de ' + months[currentDate.addDays(0).getMonth()]\n}, {\n  value: 2,\n  label: currentDate.addDays(1).getDate() + ' de ' + months[currentDate.addDays(1).getMonth()]\n}, {\n  value: 3,\n  label: currentDate.addDays(2).getDate() + ' de ' + months[currentDate.addDays(2).getMonth()]\n}, {\n  value: 4,\n  label: currentDate.addDays(3).getDate() + ' de ' + months[currentDate.addDays(3).getMonth()]\n}, {\n  value: 5,\n  label: currentDate.addDays(4).getDate() + ' de ' + months[currentDate.addDays(4).getMonth()]\n}];\n\nasync function getNearLocation(dispatch, coords) {\n  await get('distrits-islands.json', {}).then(data => {\n    dispatch({\n      type: 'SET_REGIONS',\n      regions: data.data\n    });\n\n    if (coords !== 'Blocked') {\n      let dist = null;\n      let tempLocal = null;\n      data.data.map(local => {\n        let temp = calcCrow(local.latitude, local.longitude, coords.latitude, coords.longitude);\n\n        if (dist === null) {\n          dist = temp;\n          tempLocal = local;\n        } else if (Math.abs(temp) < Math.abs(dist)) {\n          dist = temp;\n          tempLocal = local;\n        }\n      });\n      dispatch({\n        type: 'SET_NEAR_LOCATION',\n        nearLocation: tempLocal\n      });\n    } else {\n      dispatch({\n        type: 'SET_NEAR_LOCATION',\n        nearLocation: data.data[0]\n      });\n    }\n  }).catch(error => {\n    console.log(error);\n  });\n}\n\nasync function getCities(dispatch, nearLocation) {\n  await get(`http://api.ipma.pt/open-data/forecast/meteorology/cities/daily/${nearLocation.globalIdLocal}.json`, {}).then(data => {\n    dispatch({\n      type: 'SET_FORECAST',\n      forecast: data\n    });\n    dispatch({\n      type: 'SET_LOCAL',\n      local: nearLocation.local\n    });\n  }).catch(error => {\n    console.log(error);\n  });\n}\n\nfunction getLocationName(event) {\n  return event.target.attributes.name.value;\n}\n\nasync function getLocationInfo(pointedLocation, setPointedLocation, dispatch, updateForecast = false) {\n  await get(`http://api.ipma.pt/open-data/forecast/meteorology/cities/daily/${locationCodes[pointedLocation]}.json`, {}).then(data => {\n    setPointedLocation(data.data[index]);\n\n    if (updateForecast) {\n      dispatch({\n        type: 'SET_FORECAST',\n        forecast: data\n      });\n      dispatch({\n        type: 'SET_LOCAL',\n        local: pointedLocation\n      });\n    }\n  }).catch(error => {\n    console.log(error);\n  });\n}\n\nfunction handleChange(selectedNode, setPointedLocation, dispatch) {\n  getLocationInfo(selectedNode.attributes.name.value, setPointedLocation, dispatch, true);\n}\n\nfunction handleLocationMouseOver(event, setPointedLocation, dispatch) {\n  const pointedLocation = getLocationName(event);\n  getLocationInfo(pointedLocation, setPointedLocation, dispatch);\n}\n\nfunction handleLocationMouseOut(setPointedLocation, setToolTipStyle) {\n  setPointedLocation(null);\n  setToolTipStyle({\n    display: 'none'\n  });\n}\n\nfunction handleLocationMouseMove(event, setToolTipStyle) {\n  const tooltipStyle = {\n    display: 'block',\n    top: event.clientY + 20,\n    left: event.clientX - 140\n  };\n  setToolTipStyle(tooltipStyle);\n}\n\nexport { months, weekDays, locationCodes, CustomSlider, marks, getNearLocation, getCities, handleChange, handleLocationMouseOver, handleLocationMouseOut, handleLocationMouseMove };","map":{"version":3,"sources":["C:/Users/fhenriques/Documents/Rep/fe/src/utils/index.js"],"names":["Slider","withStyles","get","months","weekDays","locationCodes","Aveiro","Beja","Braga","Bragança","Coimbra","Évora","Faro","Guarda","Leiria","Lisboa","Portalegre","Porto","Santarém","Setúbal","Viseu","toRad","Value","Math","PI","calcCrow","lat1","lon1","lat2","lon2","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","d","CustomSlider","root","width","markLabel","color","markLabelActive","Date","prototype","addDays","days","date","valueOf","setDate","getDate","currentDate","marks","value","label","getMonth","getNearLocation","dispatch","coords","then","data","type","regions","dist","tempLocal","map","local","temp","latitude","longitude","abs","nearLocation","catch","error","console","log","getCities","globalIdLocal","forecast","getLocationName","event","target","attributes","name","getLocationInfo","pointedLocation","setPointedLocation","updateForecast","index","handleChange","selectedNode","handleLocationMouseOver","handleLocationMouseOut","setToolTipStyle","display","handleLocationMouseMove","tooltipStyle","top","clientY","left","clientX"],"mappings":"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","sourcesContent":["import Slider from '@material-ui/core/Slider';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport { get } from '../services/api';\r\n\r\nconst months = [\r\n\t'Janeiro',\r\n\t'Fevereio',\r\n\t'Março',\r\n\t'Abril',\r\n\t'Maio',\r\n\t'Junho',\r\n\t'Julho',\r\n\t'Agosto',\r\n\t'Setembro',\r\n\t'Outubro',\r\n\t'Novembro',\r\n\t'Dezembro',\r\n];\r\n\r\nconst weekDays = [\r\n\t'Domingo',\r\n\t'Segunda-feira',\r\n\t'Terça-feira',\r\n\t'Quarta-feira',\r\n\t'Quinta-feira',\r\n\t'Sexta-feira',\r\n\t'Sábado',\r\n];\r\n\r\nconst locationCodes = {\r\n\tAveiro: 1010500,\r\n\tBeja: 1020500,\r\n\tBraga: 1030300,\r\n\tBragança: 1040200,\r\n\t'Castelo Branco': 1050200,\r\n\tCoimbra: 1060300,\r\n\tÉvora: 1070500,\r\n\tFaro: 1080500,\r\n\tGuarda: 1090700,\r\n\tLeiria: 1100900,\r\n\tLisboa: 1110600,\r\n\tPortalegre: 1121400,\r\n\tPorto: 1131200,\r\n\tSantarém: 1141600,\r\n\tSetúbal: 1151200,\r\n\t'Viana do Castelo': 1160900,\r\n\t'Vila Real': 1171400,\r\n\tViseu: 1182300,\r\n};\r\n\r\nfunction toRad(Value) {\r\n\treturn (Value * Math.PI) / 180;\r\n}\r\n\r\nfunction calcCrow(lat1, lon1, lat2, lon2) {\r\n\tvar R = 6371; // km\r\n\tvar dLat = toRad(lat2 - lat1);\r\n\tvar dLon = toRad(lon2 - lon1);\r\n\tvar lat1 = toRad(lat1);\r\n\tvar lat2 = toRad(lat2);\r\n\r\n\tvar a =\r\n\t\tMath.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n\t\tMath.sin(dLon / 2) *\r\n\t\t\tMath.sin(dLon / 2) *\r\n\t\t\tMath.cos(lat1) *\r\n\t\t\tMath.cos(lat2);\r\n\tvar c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\tvar d = R * c;\r\n\treturn d;\r\n}\r\n\r\nconst CustomSlider = withStyles({\r\n\troot: {\r\n\t\twidth: '75%',\r\n\t},\r\n\tmarkLabel: {\r\n\t\tcolor: '#a9a9a9',\r\n\t},\r\n\tmarkLabelActive: {\r\n\t\tcolor: '#f1f1f1',\r\n\t},\r\n})(Slider);\r\n\r\nDate.prototype.addDays = function (days) {\r\n\tvar date = new Date(this.valueOf());\r\n\tdate.setDate(date.getDate() + days);\r\n\treturn date;\r\n};\r\n\r\nconst currentDate = new Date();\r\n\r\nconst marks = [\r\n\t{\r\n\t\tvalue: 1,\r\n\t\tlabel:\r\n\t\t\tcurrentDate.addDays(0).getDate() +\r\n\t\t\t' de ' +\r\n\t\t\tmonths[currentDate.addDays(0).getMonth()],\r\n\t},\r\n\t{\r\n\t\tvalue: 2,\r\n\t\tlabel:\r\n\t\t\tcurrentDate.addDays(1).getDate() +\r\n\t\t\t' de ' +\r\n\t\t\tmonths[currentDate.addDays(1).getMonth()],\r\n\t},\r\n\t{\r\n\t\tvalue: 3,\r\n\t\tlabel:\r\n\t\t\tcurrentDate.addDays(2).getDate() +\r\n\t\t\t' de ' +\r\n\t\t\tmonths[currentDate.addDays(2).getMonth()],\r\n\t},\r\n\t{\r\n\t\tvalue: 4,\r\n\t\tlabel:\r\n\t\t\tcurrentDate.addDays(3).getDate() +\r\n\t\t\t' de ' +\r\n\t\t\tmonths[currentDate.addDays(3).getMonth()],\r\n\t},\r\n\t{\r\n\t\tvalue: 5,\r\n\t\tlabel:\r\n\t\t\tcurrentDate.addDays(4).getDate() +\r\n\t\t\t' de ' +\r\n\t\t\tmonths[currentDate.addDays(4).getMonth()],\r\n\t},\r\n];\r\n\r\nasync function getNearLocation(dispatch, coords) {\r\n\tawait get('distrits-islands.json', {})\r\n\t\t.then((data) => {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: 'SET_REGIONS',\r\n\t\t\t\tregions: data.data,\r\n\t\t\t});\r\n\t\t\tif (coords !== 'Blocked') {\r\n\t\t\t\tlet dist = null;\r\n\t\t\t\tlet tempLocal = null;\r\n\t\t\t\tdata.data.map((local) => {\r\n\t\t\t\t\tlet temp = calcCrow(\r\n\t\t\t\t\t\tlocal.latitude,\r\n\t\t\t\t\t\tlocal.longitude,\r\n\t\t\t\t\t\tcoords.latitude,\r\n\t\t\t\t\t\tcoords.longitude\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (dist === null) {\r\n\t\t\t\t\t\tdist = temp;\r\n\t\t\t\t\t\ttempLocal = local;\r\n\t\t\t\t\t} else if (Math.abs(temp) < Math.abs(dist)) {\r\n\t\t\t\t\t\tdist = temp;\r\n\t\t\t\t\t\ttempLocal = local;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: 'SET_NEAR_LOCATION',\r\n\t\t\t\t\tnearLocation: tempLocal,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: 'SET_NEAR_LOCATION',\r\n\t\t\t\t\tnearLocation: data.data[0],\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n}\r\n\r\nasync function getCities(dispatch, nearLocation) {\r\n\tawait get(\r\n\t\t`http://api.ipma.pt/open-data/forecast/meteorology/cities/daily/${nearLocation.globalIdLocal}.json`,\r\n\t\t{}\r\n\t)\r\n\t\t.then((data) => {\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: 'SET_FORECAST',\r\n\t\t\t\tforecast: data,\r\n\t\t\t});\r\n\t\t\tdispatch({\r\n\t\t\t\ttype: 'SET_LOCAL',\r\n\t\t\t\tlocal: nearLocation.local,\r\n\t\t\t});\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n}\r\n\r\nfunction getLocationName(event) {\r\n\treturn event.target.attributes.name.value;\r\n}\r\n\r\nasync function getLocationInfo(\r\n\tpointedLocation,\r\n\tsetPointedLocation,\r\n\tdispatch,\r\n\tupdateForecast = false\r\n) {\r\n\tawait get(\r\n\t\t`http://api.ipma.pt/open-data/forecast/meteorology/cities/daily/${locationCodes[pointedLocation]}.json`,\r\n\t\t{}\r\n\t)\r\n\t\t.then((data) => {\r\n\t\t\tsetPointedLocation(data.data[index]);\r\n\t\t\tif (updateForecast) {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: 'SET_FORECAST',\r\n\t\t\t\t\tforecast: data,\r\n\t\t\t\t});\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: 'SET_LOCAL',\r\n\t\t\t\t\tlocal: pointedLocation,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch((error) => {\r\n\t\t\tconsole.log(error);\r\n\t\t});\r\n}\r\n\r\nfunction handleChange(selectedNode, setPointedLocation, dispatch) {\r\n\tgetLocationInfo(\r\n\t\tselectedNode.attributes.name.value,\r\n\t\tsetPointedLocation,\r\n\t\tdispatch,\r\n\t\ttrue\r\n\t);\r\n}\r\n\r\nfunction handleLocationMouseOver(event, setPointedLocation, dispatch) {\r\n\tconst pointedLocation = getLocationName(event);\r\n\r\n\tgetLocationInfo(pointedLocation, setPointedLocation, dispatch);\r\n}\r\n\r\nfunction handleLocationMouseOut(setPointedLocation, setToolTipStyle) {\r\n\tsetPointedLocation(null);\r\n\tsetToolTipStyle({ display: 'none' });\r\n}\r\n\r\nfunction handleLocationMouseMove(event, setToolTipStyle) {\r\n\tconst tooltipStyle = {\r\n\t\tdisplay: 'block',\r\n\t\ttop: event.clientY + 20,\r\n\t\tleft: event.clientX - 140,\r\n\t};\r\n\tsetToolTipStyle(tooltipStyle);\r\n}\r\n\r\nexport {\r\n\tmonths,\r\n\tweekDays,\r\n\tlocationCodes,\r\n\tCustomSlider,\r\n\tmarks,\r\n\tgetNearLocation,\r\n\tgetCities,\r\n\thandleChange,\r\n\thandleLocationMouseOver,\r\n\thandleLocationMouseOut,\r\n\thandleLocationMouseMove,\r\n};\r\n"]},"metadata":{},"sourceType":"module"}